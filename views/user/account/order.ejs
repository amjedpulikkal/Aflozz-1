<%-include("account-layout")%>
    <div class="flex justify-center">

        <ul class="container bg-white shadow overflow-hidden sm:rounded-md mt-4 ">

            <li>
                <div class="px-4 py-5 sm:px-6 border">
                    <div class="flex items-center justify-b">
                        <dir class=" w-1/3">
                            <h3 class="text-lg leading-6 font-medium text-gray-900">#Id</h3>
                        </dir>
                        <p class="w-1/3">Date</p>
                        <div class="w-2/4">
                            <!-- <div class="w-1/3"> -->
                            status
                            <!-- </div> -->
                        </div>
                    </div>
                </div>
            </li>
            <% orders.forEach(function(items) { %>
                <li>
                    <div class="px-4 py-5 sm:px-6 border">
                        <div class="flex items-center justify-between">
                            <div class="flex">
                                <h3 class="text-lg leading-6 font-medium text-gray-900">#Id</h3>
                                <a href="/account/orders/details/<%=items._id%>">
                                    <p class="ms-2">
                                        <%= items._id %>
                                    </p>
                                </a>
                            </div>
                            <p>
                                <%= items.date%>
                            </p>
                            <div class="w-2/4">
                                <div class="row-auto">
                                    <div class="col-12 col-10 hh-grayBox pt-4">
                                        <div class="flex justify between">

                                            <%if(!items.cancel){%>
                                                <div
                                                    class="order-tracking <%= (items.status.length >=1) ? 'completed' : '' %>">
                                                    <span class="is-complete"></span>
                                                    <p>Ordered<br><span>
                                                            <%= (items.status[0]?.date) ? items.status[0]?.date : '' %>
                                                        </span></p>
                                                </div>
                                                <div
                                                    class="order-tracking  <%= (items.status.length>=2) ? 'completed' : '' %>">
                                                    <span class="is-complete"></span>
                                                    <p>Shipped<br><span>
                                                            <%= (items.status[1]?.date) ? items.status[1]?.date : '' %>
                                                        </span></p>
                                                </div>
                                                <div
                                                    class="order-tracking  <%= (items.status.length >=3) ? 'completed' : '' %>">
                                                    <span class="is-complete"></span>
                                                    <p>Delivered<br><span>
                                                            <%= (items.status[2]?.date) ? items.status[2]?.date : '' %>
                                                        </span></p>
                                                </div>
                                                <%}else{%>
                                                    <div
                                                    class="order-tracking cancel">
                                                    <span class="is-complete"></span>
                                                    <p>Ordered<br><span>
                                                            <%= (items.status[0]?.date) ? items.status[0]?.date : '' %>
                                                        </span></p>
                                                </div>
                                                <div
                                                    class="order-tracking cancel">
                                                    <span class="z-10">Canceld</span>
                                                   
                                                </div>
                                                <div
                                                    class="order-tracking  cancel">
                                                    <span class="is-complete"></span>
                                                    <p>Delivered<br><span>
                                                            <%= (items.status[2]?.date) ? items.status[2]?.date : '' %>
                                                        </span></p>
                                                </div>
                                                    
                                                    
                                                    
                                                    <%}%>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <%if(items.status.length<3 && !items.cancel){%>
                                <div id="<%=items._id%>">
                                    <button onclick="cancel('<%=items._id%>')"
                                        class="bg-blue-500  rounded-full hover:bg-blue-700 text-white font-bold py-2 px-4 border border-blue-700 rounded">
                                        Cancel
                                    </button>
                                </div>
                                <%}%>
                        </div>
                    </div>
                </li>
                <% }) %>

        </ul>
    </div>

    <script>
        function cancel(id) {

            fetch('/order/cancel/' + id)
                .then(res => {
                    if (!res.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return res.json();
                })
                .then(data => {
                    document.getElementById(id).remove()
                    window.location.reload()
                    console.log(data);
                })
                .catch(error => {
                    console.error('Fetch error:', error);
                });

        }
    </script>